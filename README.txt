A viterbi algorithm with fundamental function.  